(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-33dbf3ca"],{"2f21":function(e,t,i){"use strict";var a=i("79e5");e.exports=function(e,t){return!!e&&a((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},"454f":function(e,t,i){i("46a7");var a=i("584a").Object;e.exports=function(e,t,i){return a.defineProperty(e,t,i)}},"46a7":function(e,t,i){var a=i("63b6");a(a.S+a.F*!i("8e60"),"Object",{defineProperty:i("d9f6").f})},"55dd":function(e,t,i){"use strict";var a=i("5ca1"),n=i("d8e8"),o=i("4bf8"),s=i("79e5"),c=[].sort,r=[1,2,3];a(a.P+a.F*(s((function(){r.sort(void 0)}))||!s((function(){r.sort(null)}))||!i("2f21")(c)),"Array",{sort:function(e){return void 0===e?c.call(o(this)):c.call(o(this),n(e))}})},"6fd3":function(e,t,i){"use strict";var a=i("cb32"),n=i.n(a);n.a},"85f2":function(e,t,i){e.exports=i("454f")},bd86:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var a=i("85f2"),n=i.n(a);function o(e,t,i){return t in e?n()(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}},cb32:function(e,t,i){},cc2d:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"manage"},[i("van-nav-bar",{attrs:{title:"工作安排","left-text":"首页","left-arrow":"",fixed:!0},on:{"click-left":e.onClickLeft}}),i("div",{staticClass:"con"},[i("van-cell-group",[i("van-cell",{attrs:{title:"分配人:",value:e.iName}}),i("van-cell",{attrs:{title:"企业:",value:e.company},on:{click:function(t){e.show=!0}}}),i("van-action-sheet",{attrs:{title:"选择要报事的企业:"},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[i("div",{staticClass:"content"},[i("van-radio-group",{model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[i("van-radio",{attrs:{"icon-size":"16"},on:{click:function(t){return e.qiYe(e.companyList.name,e.companyList.id)}}},[e._v(e._s(e.companyList.name))])],1)],1)]),i("van-cell",{attrs:{title:"分配位置:",value:e.locationName},on:{click:e.weiZhi}}),i("van-cell",{attrs:{title:"详细位置描述:",value:e.message1},on:{click:e.site}}),i("van-action-sheet",{attrs:{title:"报事详细位置:"},model:{value:e.show1,callback:function(t){e.show1=t},expression:"show1"}},[i("van-field",{attrs:{rows:"2",autosize:"",label:"留言",type:"textarea",maxlength:"60",placeholder:"请输入留言","show-word-limit":""},model:{value:e.message1,callback:function(t){e.message1=t},expression:"message1"}}),i("div",{staticClass:"btn flex"},[i("van-button",{attrs:{color:"#A68E44"},on:{click:e.inDetail}},[e._v("确定")]),i("van-button",{attrs:{color:"#999"},on:{click:function(t){e.show1=!1}}},[e._v("取消")])],1)],1)],1),i("div",{staticClass:"baoShiType flex_f"},[i("p",[e._v("报事类型:")]),e._l(e.baoShiType,(function(t,a){return i("span",{key:a,class:{discolor:e.changeLeftBackground==a},on:{click:function(i){return e.leftChange(t.id,a)}}},[e._v(e._s(t.eventType))])}))],2),i("div",{staticStyle:{margin:"0.5px 15px"}}),i("van-cell",{attrs:{title:"执行人：",value:e.fenPeiName},on:{click:e.chaXun}}),i("van-action-sheet",{attrs:{title:"执行人人","close-icon":""},model:{value:e.show2,callback:function(t){e.show2=t},expression:"show2"}},[i("van-search",{attrs:{"show-action":"",placeholder:"请输入搜索关键词"},on:{search:e.onSearch},scopedSlots:e._u([{key:"action",fn:function(){return[i("div",{on:{click:e.onSearch}},[e._v("搜索")])]},proxy:!0}]),model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}),i("div",{staticClass:"content"},[e._l(e.userNames,(function(t,a){return i("van-checkbox",{key:a,attrs:{"icon-size":"16"},on:{change:function(i){return e.itemName(t.vserName,t.uid,t.checked)}},model:{value:t.checked,callback:function(i){e.$set(t,"checked",i)},expression:"item.checked"}},[e._v(e._s(t.vserName))])})),i("div",{staticClass:"btn flex"},[i("van-button",{attrs:{color:"#999"},on:{click:function(t){e.show2=!1}}},[e._v("取消")]),i("van-button",{attrs:{color:"#A68F43"},on:{click:function(t){e.show2=!1}}},[e._v("确定")])],1)],2)],1),i("div",{staticClass:"time"},[i("van-cell",{attrs:{title:"开始时间：",value:e.beginTime01},on:{click:function(t){e.flag=!0}}}),1==e.flag?i("van-datetime-picker",{attrs:{type:"datetime",title:"选择完整时间：","min-date":e.minDate,"max-date":e.maxDate},on:{confirm:e.beginTime},model:{value:e.currentDate,callback:function(t){e.currentDate=t},expression:"currentDate"}}):e._e()],1),i("div",{staticClass:"planTime"},[i("van-field",{attrs:{type:"digit",label:"规定工时：",placeholder:"请选择规定工时"},model:{value:e.digit,callback:function(t){e.digit=t},expression:"digit"}})],1),i("p",[e._v("事件描述")]),i("van-field",{attrs:{rows:"2",autosize:"",type:"textarea",maxlength:"100",placeholder:"请输描述","show-word-limit":""},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}}),i("p",[e._v("添加照片")]),i("van-uploader",{attrs:{"max-count":6,"after-read":e.updateImg},on:{delete:e.remove},model:{value:e.fileList,callback:function(t){e.fileList=t},expression:"fileList"}})],1),i("div",{staticClass:"btn flex"},[i("van-button",{attrs:{color:"#A68E44"},on:{click:e.end}},[e._v("确定")]),i("van-button",{attrs:{color:"#999",to:"/"}},[e._v("取消")])],1)],1)},n=[],o=(i("5df3"),i("4f7f"),i("75fc")),s=(i("55dd"),i("7f7f"),i("34ef"),i("4917"),i("28a5"),i("ac6a"),i("bd86")),c=(i("bc3a"),{data:function(){var e;return e={iName:localStorage.getItem("userName"),show:!1,show1:!1,show2:!1,radio:""},Object(s["a"])(e,"radio",""),Object(s["a"])(e,"userNames",[]),Object(s["a"])(e,"fenPeiUid",""),Object(s["a"])(e,"reportEventTypeId",""),Object(s["a"])(e,"company",localStorage.getItem("deptName")),Object(s["a"])(e,"companyId",""),Object(s["a"])(e,"name","阿萨德"),Object(s["a"])(e,"baoShiType",[]),Object(s["a"])(e,"dispose",[{name:"指派部门"},{name:"自行处理"}]),Object(s["a"])(e,"dispose1","1"),Object(s["a"])(e,"changeLeftBackground",-1),Object(s["a"])(e,"changeLeftBackground1",0),Object(s["a"])(e,"message",""),Object(s["a"])(e,"message1",""),Object(s["a"])(e,"fileList",[]),Object(s["a"])(e,"locationName","选择"),Object(s["a"])(e,"fenPeiName","选择"),Object(s["a"])(e,"fenPeiName1",[]),Object(s["a"])(e,"companyList",[]),Object(s["a"])(e,"base64",""),Object(s["a"])(e,"base64Arr",[]),Object(s["a"])(e,"tuName",""),Object(s["a"])(e,"tuNameArr",[]),Object(s["a"])(e,"flag",!1),Object(s["a"])(e,"minDate",new Date),Object(s["a"])(e,"maxDate",new Date(2025,10,1)),Object(s["a"])(e,"currentDate",new Date),Object(s["a"])(e,"beginTime01","选择开始时间"),Object(s["a"])(e,"beginTime02","选择开始时间"),Object(s["a"])(e,"digit",""),Object(s["a"])(e,"value",""),Object(s["a"])(e,"checked",!1),Object(s["a"])(e,"executor",""),Object(s["a"])(e,"uidArr",[]),e},components:{},mounted:function(){var e=this;this.newTime(),console.log(this.beginTime02),this.department(),setTimeout((function(){e.tbEventTypeConfig()}),500),null==sessionStorage.getItem("locationName")?this.locationName="选择":this.locationName=sessionStorage.getItem("locationName")},methods:{chaXun:function(){var e=this;this.show2=!0,this.axios.post("/rest/tbEventTypeConfig/list",{uid:localStorage.getItem("uid"),id:this.reportEventTypeId}).then((function(t){e.userNames=t.rows[0].getUserInfoExecute,e.userNames.forEach((function(t){e.$set(t,"checked",e.checked)})),console.log(t.rows)}))},onClickLeft:function(){this.$router.push("/")},leftChange:function(e,t){""==this.locationName||"选择"==this.locationName?this.$toast("请先选择报事位置"):(this.changeLeftBackground=t,this.reportEventTypeId=e,console.log(e))},leftChange1:function(e,t){""==this.locationName||"选择"==this.locationName?this.$toast("请先选择报事位置"):(this.changeLeftBackground1=t,"指派部门"==e?this.dispose1="1":"自行处理"==e&&(this.dispose1="2"))},dataURLtoFile:function(e,t){var i=e.split(","),a=i[0].match(/:(.*?);/)[1],n=atob(i[1]),o=n.length,s=new Uint8Array(o);while(o--)s[o]=n.charCodeAt(o);return new File([s],t,{type:a})},updateImg:function(e){var t=this,i=document.createElement("canvas"),a=i.getContext("2d"),n=new Image;n.src=e.content,n.onload=function(){i.width=400,i.height=300,a.drawImage(n,0,0,400,300),e.content=i.toDataURL(e.file.type,.92);var o=t.dataURLtoFile(e.content,e.file.name),s=new FormData;s.append("file",o),s.append("code",t.applyNo),s.append("type","chat"),t.base64Arr.push(e.content),t.tuNameArr.push(e.file.name),t.base64=t.base64Arr.join("#"),t.tuName=t.tuNameArr.join(",")}},remove:function(e,t){var i=this;this.base64Arr.forEach((function(a){if(a==e.content)return i.base64Arr.splice(t.index,1)})),this.tuNameArr.forEach((function(a){if(a==e.file.name)return i.tuNameArr.splice(t.index,1)})),this.base64=this.base64Arr.join("#"),this.tuName=this.tuNameArr.join(",")},tbEventTypeConfig:function(){var e=this;this.axios.get("/rest/tbEventTypeConfig/getEventTypes",{params:{uid:localStorage.getItem("uid"),company_id:localStorage.getItem("companyId")}}).then((function(t){t.sort((function(e,t){return e.eventType>t.eventType?1:-1})),t.forEach((function(t){t.userIdA!=localStorage.getItem("uid")&&t.finalUserIdB!=localStorage.getItem("uid")||e.baoShiType.push(t)})),console.log(e.baoShiType),e.reportEventTypeId=e.baoShiType[0].id}))},itemName:function(e,t,i){if(console.log(e,t),console.log(i),1==i)this.fenPeiName1.push(e),this.uidArr.push(t);else if(1!=i){var a=this.uidArr.indexOf(t),n=this.fenPeiName1.indexOf(e);-1!==a&&this.uidArr.splice(a,1),-1!==n&&this.fenPeiName1.splice(n,1)}this.fenPeiName=Object(o["a"])(new Set(this.fenPeiName1)).join(","),this.executor=Object(o["a"])(new Set(this.uidArr)).join(","),console.log(this.fenPeiName),console.log(this.executor)},isRadio:function(e){1==e?(this.company="xxx公司",this.show=!1):(this.company="xxx分公司",this.show=!1)},department:function(){var e=this;this.axios.get("/rest/department/getCompanyByUid",{params:{uid:localStorage.getItem("uid")}}).then((function(t){console.log(t),e.companyList=t,e.companyId=t.id,e.company=t.name,localStorage.setItem("companyId",t.id)}))},qiYe:function(e,t){console.log(e,t),this.company=e,this.companyId=t,localStorage.setItem("companyId",t),this.show=!1},site:function(){this.show1=!0,this.message1=""},inDetail:function(){console.log(this.message1),this.show1=!1},weiZhi:function(){sessionStorage.clear(),this.$router.push("/dayTaskLocation")},p:function(e){return e<10?"0"+e:e},newTime:function(){var e=new Date;console.log(e);var t=e.getFullYear()+"/"+this.p(e.getMonth()+1)+"/"+this.p(e.getDate()),i=this.p(e.getHours())+":"+this.p(e.getMinutes())+":"+this.p(e.getSeconds());this.beginTime01=t+" "+i,this.beginTime02=new Date(this.beginTime01),console.log(this.beginTime02)},beginTime:function(e){var t=e,i=t.getFullYear()+"/"+this.p(t.getMonth()+1)+"/"+this.p(t.getDate()),a=this.p(t.getHours())+":"+this.p(t.getMinutes())+":"+this.p(t.getSeconds());this.beginTime01=i+" "+a,this.beginTime02=new Date(this.beginTime01),console.log(this.beginTime02),this.flag=!1},cancel:function(){this.flag=!1},onSearch:function(){console.log(this.value),console.log(this.userNames);for(var e=0;e<this.userNames.length;e++)console.log(this.userNames[e].vserName)},end:function(){var e=this;""==this.company?this.$toast("请选择报事企业"):"选择"==this.locationName?this.$toast("请选择报事位置"):""==this.reportEventTypeId||-1==this.changeLeftBackground?this.$toast("请选择报事类型"):""==this.executor?this.$toast("请选择执行人"):""==this.digit?this.$toast("请选择规定工时"):""==this.message?this.$toast("请填写事件描述"):this.axios.post("/rest/tbEventReport/addRCEvent",{uid:localStorage.getItem("uid"),buildingId0:sessionStorage.getItem("buildingId0"),buildingId1:sessionStorage.getItem("buildingId1"),buildingId2:sessionStorage.getItem("buildingId2"),buildingDescription:this.message1,event_remark:this.message,base64:this.base64,duration:this.digit,startTime:this.beginTime02,file_name:this.tuName,distribute_uid:localStorage.getItem("uid"),report_event_type_id:this.reportEventTypeId,company_id:this.companyId,userId:this.executor}).then((function(t){e.$toast("报事成功"),sessionStorage.removeItem("buildingId0"),sessionStorage.removeItem("buildingId1"),sessionStorage.removeItem("buildingId2"),sessionStorage.removeItem("locationName"),e.$router.push("/")}))}}}),r=c,l=(i("6fd3"),i("2877")),u=Object(l["a"])(r,a,n,!1,null,"39bf0a7a",null);t["default"]=u.exports}}]);